# Repository type definitions for standardized repo creation and naming
# This configuration defines naming patterns, templates, and branch protection rules
# for different repository types in your organization.
#
# Each type specifies:
#   - description: What this type is used for
#   - template: Optional GitHub template repo to use (use --no-template to skip)
#   - naming_pattern: Regex pattern that repo names must match
#   - naming_example: Examples of valid repo names
#   - isTemplate: Mark this repository as a GitHub template (default: false)
#   - rulesetConfigFile: Path to JSON ruleset file in config/ (null = no ruleset)
#   - post_creation_script: Script within repo to run after creation (relative path from repo root)
#   - delete_post_creation_script: Whether to delete the script after running (default: true)
#   - post_creation_commit_handling: How to handle changes after post-creation (none|amend|new)
#       - none: No automatic commit, user must handle changes
#       - amend: Amend initial commit and force push (if changes exist)
#       - new: Create new commit with changes (if changes exist)
#   - allowedMergeTypes: Repository-level merge types (merge|squash|rebase) - controls UI buttons
#       Note: This is separate from ruleset's allowed_merge_methods which applies to protected branches
#       Both settings work together - this sets repo-wide defaults, ruleset enforces on protected branches
#   - deletePRBranchOnMerge: Whether to delete PR branches after merge (default: true)
#   - hasWiki: Enable/disable Wiki feature (default: false)
#   - hasIssues: Enable/disable Issues tab (default: true, false for templates)
#   - hasDiscussions: Enable GitHub Discussions (default: false)
#   - hasProjects: Enable Projects tab (default: false)
#   - allowAutoMerge: Allow auto-merge on PRs for automation (default: true)
#   - allowUpdateBranch: Show "Update branch" button on PRs (default: true)
#   - allowForking: Allow others to fork the repository (default: true for templates, false otherwise)
#   - squashMergeCommitTitle: Title for squash merge commits (default: PR_TITLE)
#       Valid values: PR_TITLE, COMMIT_OR_PR_TITLE
#       - PR_TITLE: Use the pull request title as the commit title
#       - COMMIT_OR_PR_TITLE: Use the first commit message title or PR title (GitHub's original default)
#   - squashMergeCommitMessage: Message body for squash merge commits (default: COMMIT_MESSAGES)
#       Valid values: PR_BODY, COMMIT_MESSAGES, BLANK
#       - PR_BODY: Use the pull request description
#       - COMMIT_MESSAGES: Use all commit messages from the PR
#       - BLANK: No commit message body
#
#   GitHub UI Mapping:
#     - "Use PR title": title=PR_TITLE, message=BLANK
#     - "Use PR title and commit details": title=PR_TITLE, message=COMMIT_MESSAGES
#     - "Use PR title and description": title=PR_TITLE, message=PR_BODY
#     - "Default message": title=COMMIT_OR_PR_TITLE, message=COMMIT_MESSAGES
#
#   - access: List of teams or users with their permission levels (optional, default: none)
#       Each entry contains:
#       - name: Team or user name (GitHub team slug or username)
#       - type: 'team' or 'user' (default: team)
#       - permission: Permission level mapping to GitHub repository permissions:
#           * pull (Read) - Can pull/clone, open issues, and comment
#           * triage (Triage) - Can manage issues/PRs without write access
#           * push (Write) - Can push, create branches, and manage issues/PRs
#           * maintain (Maintain) - Push + manage releases and some settings
#           * admin (Admin) - Full access including settings, webhooks, and team management
#       If not specified, no default permissions are applied (repository remains with org defaults)

types:
  # Planning and repositories
  # Format: planning.<category>.<descriptor>
  # Examples: planning.development.main, planning.roadmap
  planning:
    description: Planning repositories
    template: template.planning
    naming_pattern: '^planning(\.[a-z0-9-]+)+$'
    naming_example: "planning.development.main or planning.roadmap"
    mainBranch: master
    allowedMergeTypes:
      - squash
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: true
    hasProjects: true
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"
    delete_post_creation_script: true
    post_creation_commit_handling: amend
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # Documentation repositories
  # Format: docs.<category>.<descriptor> or docs.<descriptor>
  # Examples: docs.api.reference, docs.user-guide, docs.architecture
  documentation:
    description: Documentation repositories
    template: template.docs
    naming_pattern: '^docs(\.[a-z0-9-]+)+$'
    naming_example: "docs.api.reference, docs.user-guide, or docs.architecture"
    mainBranch: master
    allowedMergeTypes:
      - squash
      - rebase
    deletePRBranchOnMerge: true
    hasWiki: true
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"
    delete_post_creation_script: true
    post_creation_commit_handling: amend
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # Backend microservices
  # Template repositories
  # Format: template.<descriptor>
  # Examples: template.service, template.web-app, template.cs-library
  template:
    description: Template repositories used to scaffold new projects
    template: null  # No template; these are templates themselves
    naming_pattern: '^template\.[a-z0-9-]+$'
    naming_example: "template.service or template.web-app"
    mainBranch: master
    allowedMergeTypes:
      - squash
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    isTemplate: true  # Mark this repository as a template
    post_creation_script: null
    delete_post_creation_script: true
    post_creation_commit_handling: none
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # Backend microservices
  # Format: service.<category>.<descriptor>
  # Examples: service.platform.identity, service.deathstar.user-profile
  service:
    description: Backend microservices
    template: template.service
    naming_pattern: '^service\.[a-z0-9-]+\.[a-z0-9-]+$'
    naming_example: "service.platform.identity or service.deathstar.user-profile"
    mainBranch: master
    allowedMergeTypes:
      - squash
      - rebase
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"  # Run customization script
    delete_post_creation_script: true  # Remove script after execution
    post_creation_commit_handling: amend  # Clean up initial commit
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # API Gateway services
  # Format: gateway.<category>.<descriptor>
  # Examples: gateway.platform.main, gateway.deathstar.api
  gateway:
    description: API Gateway services
    template: template-gateway
    naming_pattern: '^gateway\.[a-z0-9-]+\.[a-z0-9-]+$'
    naming_example: "gateway.platform.main or gateway.deathstar.api"
    mainBranch: master
    allowedMergeTypes:
      - squash
      - rebase
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"
    delete_post_creation_script: true
    post_creation_commit_handling: amend
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # Web applications (React, Vue, etc.)
  # Format: app.web.<descriptor>
  # Examples: app.web.admin-portal, app.web.user-dashboard
  app-web:
    description: Web applications
    template: template.app-web
    naming_pattern: '^app\.web\.[a-z0-9-]+$'
    naming_example: "app.web.portal or app.web.user-dashboard"
    mainBranch: master
    allowedMergeTypes:
      - squash
      - rebase
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"
    delete_post_creation_script: true
    post_creation_commit_handling: amend
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # C# libraries and packages published to GitHub/NuGet
  # Format: lib.cs.<category>[.<subcategory>].<descriptor>
  # Examples: lib.cs.common.utilities, lib.cs.platform.auth.core
  cs-library:
    description: C# libraries and packages
    template: template.cs-library
    naming_pattern: '^lib\.cs\.[a-z0-9-]+(\.[a-z0-9-]+)*\.[a-z0-9-]+$'
    naming_example: "lib.cs.common.utilities or lib.cs.platform.auth.core"
    mainBranch: master
    allowedMergeTypes:
      - squash
      - rebase
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"
    delete_post_creation_script: true
    post_creation_commit_handling: amend
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # TypeScript/JavaScript packages
  # Format: pkg.ts.<descriptor>
  # Examples: pkg.ts.ui-components, pkg.ts.api-client
  ts-package:
    description: TypeScript/JavaScript packages
    template: template.ts-package
    naming_pattern: '^pkg\.ts\.[a-z0-9-]+$'
    naming_example: "pkg.ts.ui-components or pkg.ts.api-client"
    mainBranch: master
    allowedMergeTypes:
      - squash
      - rebase
    deletePRBranchOnMerge: true
    hasWiki: false
    hasIssues: true
    hasDiscussions: false
    hasProjects: false
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: false
    squashMergeCommitTitle: PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    post_creation_script: ".repo/post-create.sh"
    delete_post_creation_script: true
    post_creation_commit_handling: amend
    rulesetConfigFile: ruleset-default.json
    access:
      - name: Engineering
        type: team
        permission: push

  # Use for experimental, temporary, or special-case repos
  # These can have any kebab-case name
  none:
    description: Repositories with no enforced naming or protection
    template: null  # No template used
    naming_pattern: '^[a-z0-9][a-z0-9-]*[a-z0-9]$'
    naming_example: "any-valid-repo-name"
    mainBranch: master
    allowedMergeTypes:
      - merge
      - squash
      - rebase
    deletePRBranchOnMerge: false
    hasWiki: true
    hasIssues: true
    hasDiscussions: true
    hasProjects: true
    allowAutoMerge: false
    allowUpdateBranch: true
    allowForking: true
    squashMergeCommitTitle: COMMIT_OR_PR_TITLE
    squashMergeCommitMessage: COMMIT_MESSAGES
    rulesetConfigFile: null
    access:
      - name: Engineering
        type: team
        permission: push
