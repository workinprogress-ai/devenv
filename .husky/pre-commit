#!/bin/sh

# Check if there are any staged changes in tools/ or .devcontainer/
if git diff --cached --name-only | grep -qE '^(tools/|\.devcontainer/)'; then
    echo "Changes detected in tools/ or .devcontainer/ - running tests and linting..."
    
    # Run linting
    if ! ./tools/scripts/lint-scripts.sh; then
        echo "Linting failed. Commit aborted."
        exit 1
    fi
    
    # Run tests
    if ! ./tools/tests/run-tests-local.sh; then
        echo "Tests failed. Commit aborted."
        exit 1
    fi
    
    echo "All checks passed!"
fi
